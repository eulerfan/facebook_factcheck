---
title: "False and Misleading Information on Hyperpartisan Facebook Pages"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

The social media world is becoming more and more polarized. One of the early glimpses of this was the 2016 elections. There is a strong element of disinformation throughout social media. This project is based on research done by Buzzzfeed on Facebook leading up to the 2016 presidential elections. The data was acquired over seven week days (September 19 through 23rd and September 26th and 27th, 2016.) 
 The research included 1145 posts from mainstream political pages (Politico, CNN, ABC), 666 from right-wing political pages (Freedom Daily, Eagle Rising, Right Wing News), 471 from left-wing pages (The Other 98%, Addicting Info, Occupy Democrats ).
The pages were ranked based on:

•	“Mostly True: The post and any related link or image are based on factual information and portray it accurately. This lets them interpret the event/info in their own way, so long as they do not misrepresent events, numbers, quotes, reactions, etc., or make information up. This rating does not allow for unsupported speculation or claims.

•	“Mixture of True and False: Some elements of the information are factually accurate, but some elements or claims are not. This rating should be used when speculation or unfounded claims are mixed with real events, numbers, quotes, etc., or when the headline of the link being shared makes a false claim but the text of the story is largely accurate. It should also only be used when the unsupported or false information is roughly equal to the accurate information in the post or link. Finally, use this rating for news articles that are based on unconfirmed information.

•	“Mostly False: Most or all of the information in the post or in the link being shared is inaccurate. This should also be used when the central claim being made is false.

•	“No Factual Content: This rating is used for posts that are pure opinion, comics, satire, or any other posts that do not make a factual claim. This is also the category to use for posts that are of the “Like this if you think...” variety.

DATA SOURCE:

 All nine pages have earned the verified blue checkmark from Facebook. The additional data gathered was Facebook engagement numbers (shares, comments, and reactions). Each posts was noted whether it was a link, photo, video, or text The data comes from Kaggle( https://www.kaggle.com/mrisdal/fact-checking-facebook-politics-pages.) It was submitted by a journalists from the news site Buzzfeed News and the original story was ( “Hyperpartisan Facebook Pages Are Publishing False And Misleading Information At An Alarming Rate” )
 
DATA WRANGLING:

 The data was not very messy. I did have to rename some features.  Account id, post id, and the post url were integers that were changed to character strings. Date Published was a factor that was changed to a date. 
     There were a few NAs that had to be changed in the columns share count, reaction count, and the comment count. The NAs were changed to the median instead of the mean, because the outliers of all of these columns caused each of them to be heavily skewed to the right. 

```{r}
library(digest)
library(dplyr)
library(tidyr)
library(readr)
library(ggplot2)
library(scales)
library(plotly)

fb<-read.csv("file:///C:/Users/John/Documents/R/fact-checking-facebook-politics-pages/facebook-fact-check.csv")

summary(fb)

#check which types of stories recieved more engagement
table(fb$Post.Type)

table(fb$Rating)


```


```{r}
#Renameing features
fb$account_id <- as.character(fb$account_id)
fb$post_id <- as.character(fb$post_id)
fb$Post.URL <- as.character(fb$Post.URL)
fb$Date.Published <- as.Date(fb$Date.Published)

#correcting na
fb[which(is.na(fb$share_count)),"share_count"]<- 87
fb[which(is.na(fb$reaction_count)),"reaction_count"]<- 543
fb[which(is.na(fb$comment_count)),"comment_count"]<- 131

#assigning variables
Total_count<- (fb$share_count+ fb$reaction_count+fb$comment_count)

fals_tags<-fb[fb$Rating=="mostly false",]
Acount<-fb[fb$Page == "Addicting info",]



  

ggplot(fb,aes(x=Category,y = percent(1), fill= Rating))+
   geom_bar(position = "fill",stat = "identity") +
  ggtitle( "Facebook Posts Content Ratings")+
  theme(axis.title.y =element_blank())

ggplot(fb,aes(x=Rating,y= reaction_count,color= Category))+
  geom_boxplot(coef=3, fun = median)+
  coord_cartesian(ylim=c(0,50000))+
  ggtitle("Ratings vs. Reaction Count")

ggplot(fb,aes(x=Rating,y= share_count,color= Category))+
  geom_boxplot(coef=3, fun = median)+
  coord_cartesian(ylim=c(0,50000))+
  ggtitle("Ratings vs. Share Count")

ggplot(fb,aes(x=Rating,y= comment_count,color= Category))+
  geom_boxplot(coef=3, fun = median)+
  coord_cartesian(ylim=c(0,50000))+
  ggtitle("Ratings vs. Comment Count")
  
ggplot(fb, aes(x=Date.Published, y= Total_count))+
  geom_point()+
  ggtitle("Total Counts on Posted Dates")

ggplot(fb,aes(reaction_count,Rating))+
  geom_point()+
  geom_smooth()

summary(fb)
str(fb)
#View(fb)


```
```{r}
ggplot(fb, aes(x=Page,fill= Rating))+
  geom_bar()+
  coord_flip()+
  ggtitle("Truth Ratings for Indivdual Pages")


ggplot(fb,aes(x=Post.Type,y= reaction_count, col=Rating))+
  geom_point(position = "jitter")+
  facet_grid(Post.Type ~ Rating)+
  coord_cartesian(ylim=c(0,50000))+
   theme( axis.text.x.bottom = element_blank())+
  ggtitle("Truth Ratings Based on Post Type")


ggplot(data=fb)+
  geom_point(mapping= aes(x=Post.Type, y= Total_count, position= "dodge"))+
  facet_wrap( ~ Rating,nrow = 2)+
  ggtitle("Truth Ratings for Post Types")

```
```{r fig.height=6.5, fig.width=9}
ggplot(fb,aes(x=Rating, group=Page))+
  geom_bar(aes(y = ..prop.., fill = factor(..x..)), stat="count") +
    geom_text(aes( label = scales::percent(..prop..),
                   y= ..prop.. ), stat= "count", vjust = -.5) +
    labs(y = "Percent", fill="Rating") +
    facet_wrap(~Page, labeller = label_value) +
    scale_y_continuous(labels = scales::percent)+
  coord_flip()+
  ggtitle("Percent of Truth Ratings Based on Pages")+
  theme(axis.ticks = element_blank(), 
        axis.text = element_blank(),
        legend.position="bottom")+
        scale_fill_discrete(labels=c("Mixture of True and False","Mostly False","Mostly True","No Factual Content"))


ggplot(fb,aes(x=Rating, group=Category))+
  geom_bar(aes(y = ..prop.., fill = factor(..x..)), stat="count") +
    geom_text(aes( label = scales::percent(..prop..),
                   y= ..prop.. ), stat= "count", vjust = -.5) +
    labs(y = "Percent", fill="Rating") +
    facet_grid(~Category) +
    scale_y_continuous(labels = scales::percent)+
  coord_flip()+
  ggtitle("Percent of Truth Ratings Based on Partisain Leaning")+
  theme(axis.ticks = element_blank(), 
        axis.text = element_blank(),
 legend.position="bottom")+
        scale_fill_discrete(labels=c("Mixture of True and False","Mostly False","Mostly True","No Factual Content"))
```
```{r}

ggplot(fb, aes(Date.Published, group = Category)) + 
          geom_bar(aes(y = ..prop..), stat="count") + 
          scale_y_continuous(labels=scales::percent) +
          ylab("relative frequencies") +
          facet_grid(Category~.)+
  ggtitle("Activity of Posts")

ggplot(fb)+
  geom_point(mapping = aes(x= reaction_count,y= Total_count))+
  facet_grid(.~Rating)+
  xlim(0,50000)+
  ylim(0,50000)+
  labs(x="")+
  theme(axis.ticks = element_blank(), 
        axis.text = element_blank())+
  ggtitle("Reactions of the pages Based On Truth")

```


```{r}
slices<-c(12231655,8953222,1176975)
lbls1 <- c("Reaction Count","Share Count","Comment Count")
pct<- round(slices/sum(slices)*100)
lbls1<- paste(lbls1,pct)
lbls1<-paste(lbls1,"%",sep = "")
pie(slices,labels = lbls1, col = rainbow(length(lbls1)))


vals<- c(89.53222,122.31655,11.76975)
val_names<- sprintf("%s(%s)", c("Share Count","Reaction Count"," Comment Count"),scales::percent(round(vals/sum(vals),digits=4)))
names(vals)<-val_names

waffle::waffle(vals, rows=8)+
  ggthemes::scale_fill_tableau(name=NULL)+
  ggtitle("Total Count")+
  labs(x=" 1 square = 100,000")

fals_tags<-fb[fb$Rating=="mostly false",]


ggplot(data = fals_tags)+
 geom_bar(mapping = aes(x = Category, fill = Page))+
  ggtitle("Mostly False based Left vs. Right")



```

```{r}
ggplot(fb,aes( x= Post.Type,y=Total_count, fill=Category))+
  geom_col()+
  facet_grid(Post.Type ~ Rating)+
  coord_cartesian(ylim=c(0,50000))+
   theme( axis.text.x.bottom = element_blank())+
  ggtitle("Truth Ratings Based on Post Type")

```


Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
